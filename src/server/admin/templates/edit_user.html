{% extends "base.html" %}


{% block javascript_variables %}
    <script>
        let addUserToPlaylistAPI = "{{ url_for("api.add_playlists_to_user") }}";
        let removePlaylistFromUserAPI = "{{ url_for("api.remove_playlist_from_user") }}"
    </script>



{% endblock %}

{% block main %}

    <div class="center">
        <h3>{{ user.username }}</h3>
    </div>

    <div class="table-wrapper">
        <table class="striped highlight own-responsive-table">
            <thead>
            <tr>
                <th>Name</th>
                <th>ID</th>
                <th>Tracks</th>
                <th>Author</th>
                <th style="width: 1px"></th>
            </tr>
            </thead>
            {% if playlist_list != [] %}
                <tbody>
                {% for playlist in playlist_list %}
                    <tr class="playlist" id="{{ playlist.id }}">
                        <td>
                            <a class="pointer underline black-text playlist-name"
                               onclick="window.open('{{ playlist.external_urls.spotify }}')">{{ playlist.name }}</a>
                        </td>
                        <td>{{ playlist.id }}</td>
                        <td>{{ playlist.tracks.total }}</td>
                        <td>
                            <a class="pointer underline black-text"
                               onclick="window.open('{{ playlist.owner.external_urls.spotify }}')">{{ playlist.owner.display_name }}</a>
                        </td>
                        <td><i class="material-icons pointer primary-text-color">delete</i></td>
                    </tr>
                {% endfor %}
                </tbody>
            {% else %}
                <tr id="no-playlists-placeholder">
                    <td></td>
                    <td></td>

                    <td class="center-align">No Playlists</td>

                    <td></td>
                    <td></td>
                </tr>
            {% endif %}
        </table>
    </div>

    <ul>
        <li class="divider"></li>
    </ul>

    <h5 class="margin-bottom">Add Playlists to User</h5>

    <div class="input-field col s12">
        <select aria-label="playlist-select" multiple id="playlist-select">
            {# Fill in the playlists for the user #}
            {% if all_playlists_list != [] %}
                <option value="" disabled selected>Select a Playlist</option>

                {% for playlist in all_playlists_list %}
                    <option value="{{ playlist.id }}">{{ playlist.name }}</option>
                {% endfor %}
            {% else %}
                <option value="" disabled selected>No Playlists available</option>
            {% endif %}

        </select>
    </div>

    <div class="right-align">
        <a class="waves-effect waves-green btn-flat" id="add-playlist">Add</a>
    </div>



{% endblock %}


{% block javascript %}
    <script type="text/javascript" src="/static/js/own/edit_user/add.js"></script>
    <script type="text/javascript" src="/static/js/own/edit_user/remove.js"></script>
    <script type="text/javascript" src="/static/js/own/edit_user/main.js"></script>
    <script type="text/javascript" src="/static/js/own/useful_functions.js"></script>

{% endblock %}